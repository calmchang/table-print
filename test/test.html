<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title></title>

  <script src="../lib/index.js"></script>
  <link rel="stylesheet" type="text/css" href='./test.css' />

</head>
<body>
<button id="ok1">横向打印</button>
<button id="ok2">竖向打印</button>
<section id="print">

</section>
<script>
window.onload=function(){
  var table=`
    <h1 class="title">
      产品申请单
      <span>2021-01-01</span>
    </h1>
    <table >
      <thead></thead>
      <tbody class="applyInfo" >
        <tr>
          <td>申请人</td>
          <td>测试人</td>
          <td>申请人部门</td>
          <td>测试部门</td>
        </tr>
        <tr>
          <td>总额</td>
          <td>￥123.00</td>
          <td>备注</td>
          <td>123123</td>
        </tr>
      </tbody>
    </table>
    <table className="itemList">
    <thead>
      <tr>
        <th>产品编码</th>
        <th>产品名称</th>
        <th>产品型号</th>
        <th>单价(￥)</th>
        <th>内采数量</th>
        <th>总价(￥)</th>
      </tr>
    </thead>
    <tbody>
      @list
    </tbody>
  </table>
    <hgroup>
      <div>确认签字</div>
      <table>
        <thead></thead>
        <tbody>
          <tr>
            <td>申请人</td>
            <td></td>
            <td>收单人</td>
            <td></td>
          </tr>
          <tr>
            <td>上级审批</td>
            <td></td>
            <td>CEO确认</td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </hgroup>
  
    <table className="itemList">
    <thead>
      <tr>
        <th>产品编码2</th>
        <th>产品名称</th>
        <th>产品型号</th>
        <th>单价(￥)</th>
        <th>内采数量</th>
        <th>总价(￥)</th>
      </tr>
    </thead>
    <tbody>
      @list
    </tbody>
  </table>

  <hgroup >
      <div>确认签字2</div>
      <table>
        <thead></thead>
        <tbody>
          <tr>
            <td>申请人</td>
            <td></td>
            <td>收单人</td>
            <td></td>
          </tr>
          <tr>
            <td>上级审批</td>
            <td></td>
            <td>CEO确认</td>
            <td></td>
          </tr>
          <tr>
            <td>上级审批</td>
            <td></td>
            <td>CEO确认</td>
            <td></td>
          </tr>

        </tbody>
      </table>
    </hgroup>
    `

  let list='';
  for(let i=0;i<15;i++){
    var dom = `
      <tr>
        <td>${i}</td>
        <td>${i}</td>
        <td>${i}</td>
        <td>${i}</td>
        <td>${i}</td>
        <td>${i}</td>
      </tr>
      `
      list+=dom;
  }
  table=table.replace('@list',list);
  table=table.replace('@list',list);
  
  
  var domPrint = document.querySelector('#print');
  domPrint.innerHTML = table;

  var header = document.createElement('div');
  header.innerText='上海XXXX有限公司';
  header.className='title';

  var TablePrint = TablePrint||window['js-table-print'].default;
  var landscape=true;


  function DoPrint(){
    let plugin = new TablePrint({
      children:domPrint.children,
      header:header,
      footer:true,
      landscape:landscape,
      water:true,
      debug:false
    });
    plugin.print(false);
  }

  document.querySelector('#ok1').onclick=function(){
    landscape=true;
    DoPrint();
  }
  document.querySelector('#ok2').onclick=function(){
    landscape=false;
    DoPrint();
  }
}



  </script>
</body>
</html>
